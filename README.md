https://github.com/ShinQWE/web-larek-frontend

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта

Проект основан на модуле «Объектно-ориентированное программирование (ООП) и архитектура приложений». Он использует шаблон Модель-Представление-Презентатор (MVP)

MVP:

- Model : эта часть приложения работает с данными, выполняет расчеты и управляет всеми бизнес-процессами.
- View : эта часть приложения отображает пользовательский интерфейс и данные модели на экране.
- Presenter : эта часть приложения обеспечивает соединение и выступает в качестве посредника между моделью и представлением.

## Типы данных

В проекте используется несколько типов данных и интерфейсов:

- IBasketView: интерфейс, описывающий содержимое корзины

```
interface IBasketView {
	items: HTMLElement[];
	total: number | string;
	selected: string[];
}
```

- IModalData: представляет собой содержимое модального окна

```
interface IModalData {
   content: HTMLElement;
}
```

- IFormState: интерфейс описывает состояние полей формы

```
interface IFormState {
   valid: boolean;
   errors: string[];
}

```

- IPage: интерфейс позволяет определить структуру данных для страницы

```
interface IPage {
	catalog: HTMLElement[]; // каталог карт выводимых на сайт
	locked: boolean; // открыта ли карточка
}

```

- IActions: определяет структуру данных для действий

```
interface IActions {
	onClick: (event: MouseEvent) => void;
}


```

- ISuccessActions: интерфейс представляет собой функцию обратного вызова, которая будет вызываться при успешном выполнении

```
interface ISuccessActions {
	onClick: () => void;
}
```

- ISuccess: оформление заказа

```
interface ISuccess {
	id: string; // Идентификатор завершенного заказа
	total: number; // Цена заказа (Итог)
}
```

- ICardActions: void, представляет собой функцию обратного вызова, которая будет вызываться при клике на элементе

```
interface ICardActions {
   onClick: (event: MouseEvent) => void;
}
```


- categoryType: тип категории товара

```
const categoryType: { [value: string]: string } = {
	'софт-скил': 'card__category_soft',
	'хард-скил': 'card__category_hard',
	'кнопка': 'card__category_button',
	'дополнительное': 'card__category_additional',
	'другое': 'card__category_other',
};
```

- paymentType: тип способа оплаты

```
const paymentType: { [value: string]: string } = {
	'card': 'online',
	'cash': 'offline',
};
```

```
type TErrorsOrder = Partial<Record<keyof IOrder, string>>; - тип описывающий ошибки интерфейса IOrder
type TErrorsContacts = Partial<Record<keyof IContacts, string>>; - тип описывающий ошибки интерфейса IContacts
```

- IActions: интерфейс определяет действия, которые могут быть выполнены с карточкой товара

```
interface IActions {
	onClick: (event: MouseEvent) => void;
}
```

- IPage: интерфейс определяет основные характеристики главной страницы

```
interface IPage {
	catalog: HTMLElement[]; // каталог карт выводимых на сайт
	locked: boolean; // открыта ли карточка
}
```

- ProductStatus: тип статус товара

```
type TProductStatus = 'active' | 'closed';
```

- ICardProduct: интерфейс описание карточки
```
interface ICardProduct {
	id: string; // id
	category: string; // категория товара
	image: string; // картинка
	description: string; // описание товара
	title: string; // название товара
	price: number | null; // цена
}
```

- IOrderForm: интерфейс, описывающий адрес доставки товара

```
interface IOrderForm {
	payment: string; // способ оплаты (при получении/онлайн)
	address: string; // адресс
}
```

- IContactsForm: интерфейс, описывающий контактные данные

```
interface IContactsForm {
	email: string; // email
	phone: string; // телефон
}
```

- IContacts: интерфейс расширяет IContactsForm(контактные данные)

```
interface IContacts extends IContactsForm {
	itemsContact: string[];
}
```

- ICardItem: интерфейс расширяет ICardProduct(описание карточки)

```
interface ICardItem extends ICardProduct {
	buttonText: string;
	itemCountProducts: string | number;
}
```

- IOrder: интерфейс, описывающий список товаров

```
interface IOrder extends IOrderForm, IContactsForm {
	items: string[];
	total: number | string;
}
```

- IAppData: интерфейс определяет структуру данных и методы, которые могут быть использованы для управления состоянием приложения

```
interface IAppData {
	basketItem: ICardProduct[];
	catalog: ICardProduct[];
	order: IOrder;
	TErrorsOrder: TErrorsOrder;
	TErrorsContacts: TErrorsContacts;
	toggleBasket(item: ICardProduct): void;
	clearBasket(): void;
	getTotal(): number;
	getBasket(): ICardProduct[];
	setCatalog(items: ICardProduct[]): void;
	setOrderField(field: keyof IOrderForm, value: string): void;
	setContactField(field: keyof IContactsForm, value: string): void;
	validateOrder(): boolean;
	validateContacts(): boolean;
}
```

## Компоненты данных

### AppData
Класс AppState наследует IAppData. Этот класс представляет собой модель данных для управления состоянием приложения. 

- basketItem : массив типа ICardProduct[], представляет собой список товаров в корзине
- catalog : массив типа ICardProduct[], представляет собой список товаров в каталоге
- order : тип объекта IOrder, представляет информацию о заказе
- TErrorsOrder : тип объекта представляет ошибки
- TErrorsContacts : объект типа представляет ошибки
- toggleBasket(item: ICardProduct) : функция для спосоа переключения состояния товара в корзине
- clearBasket() : функция для способа очистки корзины
- getTotal() : функция для получения общей стоимости товаров в корзине
- getBasket() : функция для получения списка товаров в корзине
- setCatalog(items: ICardProduct[]) : функция для установки список товаров в каталоге
- setOrderField(field: keyof IOrderForm, value: string) : функция для установки значения поля заказа
- setContactField(field: keyof IContactsForm, value: string) : функция для установки поля значения контактных данных
- validateOrder() : функция для проверки корректности данных заказа
- validateContacts() : функция для проверки корректности контактных данных

### Larek
Класс для связи получения информации с сервера. Наследует базовый класс Api

- cdn : строка, представляет собой URL-адрес
- constructor(cdn: string, baseUrl: string) : конструктор класса вызывает конструктор родительского класса Api и устанавливает значение поля cdn
- getProductList(): Promise<ICardProduct[]> : метод, возвращает список товаров типа
- orderProduct(order: IOrder): Promise<ISuccess> : метод, представляющий собой успешный результат операции

## Базовый код

Базовый код включает в себя несколько классов:

### EventEmitter:
Проект Web-larek использует класс EventEmitter для обработки событий. Этот класс действует как центральный брокер событий, позволяя компонентам подписываться на события, прослушивать их и реагировать соответствующим образом.
EventEmitter базовый класс, который позволяет компонентам подписываться на события или прослушивать их и реагировать на них.

- _events : тип объекта Map<EventName, Set<Subscriber>>, представляет события и их подписчиков
- constructor() : конструктор класса, инициализирует поле _events как новый экземпляр Map <EventName, Set<Subscriber>>
- on<T extends object>(eventName: EventName, callback: (event: T) => void) : метод, содержащий имя события eventNameи функцию обратного вызова callback (Установить обработчик на событие)
- off(eventName: EventName, callback: Subscriber) : метод, содержащий имя события eventName и функцию обратного вызова callback (Снять обработчик с события)
- emit<T extends object>(eventName: string, data?: T) : метод, инициирует событие, вызывая все функции обратного вызова, связанные с указанным событием (Инициировать событие с данными)
- onAll(callback: (event: EmitterEvent) => void) : метод, принимающий функцию обратного вызова callback (Слушать все события)
- offAll() : метод, удаляющий все события и их подписчиков (Сбросить все обработчики)
- trigger<T extends object>(eventName: string, context?: Partial<T>) : метод инициирует событие с указанным именем и переданными данными (Сделать коллбек триггер, генерирующий событие при вызове)

### api
api базовый класс для взаимодействия с API и сервером, также наследует класс Api. Этот класс обеспечивает базовые методы для выполнения запросов GET и POST к API, используя базовый URL.

- baseUrl : строка, представляющая базовый URL для API
- options : тип объекта RequestInit, представляющий собой необязательные параметры, такие как заголовки
- constructor(baseUrl: string, options: RequestInit = {}) : конструктор класса, содержащий базовый URL и опции для поиска
- handleResponse(response: Response): Promise<object> : метод обрабатывает запрос и возвращает промис с данными
- get(uri: string) : метод для выполнения GET запроса по указанному uri
- post(uri: string, data: object, method: ApiPostMethods = 'POST') : метод для выполнения POST-запроса по указанному uri с переданными данными data и методом method

### Component:
Component класс представления, от которого наследуются все остальные классы представлений. Инструментарий для работы с DOM в дочерних компонентах.
Это элемент DOM, который будет использоваться как контейнер для компонента. В этом контейнере будут добавляться создаваемые элементы, а также выполняться различные операции по конфигурации DOM-структур.

- constructor(protected readonly container: HTMLElement) : конструктор класса, содержащий элемент контейнера container
- toggleClass(element: HTMLElement, className: string, force?: boolean) : метод переключения класса у элемента element
- setText(element: HTMLElement, value: unknown) : метод установки текстового содержимого элемента element
- setDisabled(element: HTMLElement, state: boolean) : метод изменения состояния блокировки элемента element
- setHidden(element: HTMLElement) : метод для скрытия элемента element
- setVisible(element: HTMLElement) : метод отображения элемента element. Удаляет display элемент стиля
- setImage(element: HTMLImageElement, src: string, alt?: string) : метод установки изображения элемента element
- render(data?: Partial<T>): HTMLElement : метод отрисовки компонент

### Model:

Этот класс дает базовую функциональность для моделей, сообщает об изменениях и взаимодействиях с другими компонентами через события события.

// Гарда для проверки на модель (функция для проверки)

```
export const isModel = (obj: unknown): obj is Model<any> => {
	return obj instanceof Model;
};
```

- constructor(data: Partial<T>, protected events: IEvents) : конструктор класса, содержащий частичные данные data типа и типа Partial<T>событий объекта . Копирует переданные данные в экземпляр модели.eventsIEvents
- emitChanges(event: string, payload?: object) : метод для сообщения всем подписчикам об изменениях в модели

## Компоненты представления

Компоненты представления включают в себя несколько классов:

### Modal
Этот класс обеспечивает функциональность для работы с модальным окном, включая открытие, закрытие и установку содержимого, наследует класс Component.

- constructor(container: HTMLElement, protected events: IEvents) : конструктор класса, содержащий элемент контейнера container и тип событий IEvents. Вызывает конструктор родительского класса Component и инициализирует защищенные поля _closeButtonи _content, которые представляют собой кнопку закрытия и содержимое модального окна соответственно
- set content(value: HTMLElement) : сеттер для установки содержимого модального окна
- open() : метод открытия модального окна
- close() : метод закрытия модального окна
- render(data: IModalData): HTMLElement : метод для отрисовки модального окна

### Form
Этот класс обеспечивает функциональность для работы с формами, включая обработку ввода данных, валидацию, отображение ошибок и т. д., наследует класс Component

- constructor(protected container: HTMLFormElement, protected events: IEvents) : конструктор классов вызывает конструктор родительского класса Componentи инициализирует защищенные поля _submitи _errors, которые представляют собой кнопку отправки формы и элемент для отображения ошибок соответственно. Также создают обработчики событий для ввода данных и отправки форм
- onInputChange(field: keyof T, value: string) : защищенный метод для обработки изменений ввода данных
- set valid(value: boolean) : сеттер для установки состояния валидности формы
- set errors(value: string) : сеттер для установки текста ошибок
- render(state: Partial<T> & IFormState) : метод для отрисовки форм

### Card
Этот класс предоставляет функциональные возможности для управления и отображения элементов карты, включая обработку взаимодействий с пользователем и обновление визуального представления карты на основе предоставленных данных. Наследует класс Component

- constructor(container: HTMLElement,actions?: ICardActions) : конструктор инициализирует различные защищенные поля, представляющие различные элементы в карточке, такие как заголовок, изображение, описание, кнопка, категория, цена и индекс. Он также устанавливает прослушиватели событий для действия нажатия кнопки
- set/get id(value: string) : метод установить/получить id товара
- set/get title(value: string) - метод установить/получить название товара
- set/get title() : метод получения и установки заголовка элемента карточки
- set/get index() : метод получения и установки индекса элемента карточки
- set buttonText(status: string) : установливает текст, отображаемого на кнопке
- set category(value: string) : сеттер для категории элемента карточки, устанавливающий текст категории 
- set price(value: null | number) : сеттер устанавливает цену элемента карточки
- set description(value: string | string[]) : сеттер для описания элемента карты

### Basket
Этот класс предоставляет функциональные возможности для управления и отображения корзины элементов, включая обновление списка элементов, обработку взаимодействий пользователя, наследует класс Component

- constructor(container: HTMLElement, protected events: EventEmitter) : конструктор инициализирует различные защищенные поля, представляющие различные элементы в корзине, такие как список товаров, общая стоимость и кнопки действий. Он также настраивает прослушиватели событий для действий нажатия кнопки
- set items(items: HTMLElement[]) : сеттер для обновления списка элементов в корзине. Он заменяет существующий список новыми элементами или отображает сообщение, если корзина пуста, а также управляет отключенным состоянием кнопки действия на основе наличия элементов
- set selected(items: ICardProduct[]) : сеттер для управления отключенным состоянием кнопки действия на основе наличия выбранных элементов
- set total(total: number) : сеттер для обновления общей цены, отображаемой в корзине

### Page
Этот класс обеспечивает функциональность для управления и отображения страницы, включая обновление счетчика корзины, обновление каталога товаров и управление заблокированными, наследует класс Component

- constructor(container: HTMLElement, protected events: IEvents) : конструктор инициализирует различные защищенные поля, представляющие различные элементы на странице, такие как счетчик корзин, каталог, оболочка и корзина. Он также устанавливает прослушиватель событий для действия нажатия корзины.
- set counter(value: number | null) : сеттер для обновления значения счетчика корзины
- set catalog(items: HTMLElement[]) : сеттер для обновления каталога элементов, отображаемых на странице. Заменяет существующий каталог новыми элементами
- set locked(value: boolean) : сеттер для управления заблокированным состоянием страницы

Эти классы наследуются от Component класса и содержат методы для управления соответствующими элементами.

### FormContacts
Этот класс предоставляет функциональные возможности, специфичные для контактной формы, позволяя вам устанавливать значения для ввода телефона и адреса электронной почты, наследуются от Form класса

- constructor(container: HTMLFormElement, events: IEvents) : конструктор вызывает конструктор родительского класса Form с предоставленными аргументами
- phone(value: string) : сеттер для установки значения поля ввода телефона в форме
- email(value: string) : сеттер для установки значения поля ввода email в форме

### Order
Класс предназначен для выбора способа оплаты и ввода адреса доставки, наследуются от Form класса

- constructor(container: HTMLFormElement, events: IEvents, actions?: IActions) : вызывает конструктор родительского класса Form с предоставленными аргументами. Он также инициализирует поля _cardBtnи _cashBtn, представляющие кнопки оплаты картой и наличными, и настраивает прослушиватели событий для действий нажатия кнопки
- set address(value: string) : сеттер для установки значения поля ввода адреса в форме
- set paymentMethod(value: HTMLElement) : метод переключения активного состояния кнопок способа оплаты

Эти классы наследуются от Form класса и содержат методы для управления соответствующими элементами.

### Success
Класс для успешной оплаты.

- constructor(container: HTMLElement, actions?: ISuccessActions) : вызывает  родительского класса Componentс предоставленными аргументами. Он также инициализирует _closeполе, представляющее элемент кнопки закрытия, и настраивает прослушиватель событий для действия нажатия кнопки
- set total(total: string | number) : сеттер для обновления общего значения, отображаемого в сообщении об успешном выполнении


## Взаимодействие между компонентами

Взаимодействие между компонентами в проекте Web-larek основано на архитектуре Model-View-Presenter (MVP).
Модель-представление-презентатор (MVP)

Основные компоненты
- Модель : Это часть приложения, которая работает с данными, выполняет вычисления и управляет всеми бизнес-процессами. В этом проекте класс AppDataотвечает за модель. Он содержит методы для управления данными, связанными с полями корзины, каталогом, заказом и контактами.
- View : Это часть приложения, которая отображает пользовательский интерфейс и данные модели на экране. Компоненты View в этом проекте включают такие классы, как Modal, Formи другие, которые наследуются от Componentкласса. Эти классы содержат методы для управления отображением и поведением различных элементов интерфейса.
- Presenter : Это часть приложения, которая обеспечивает связь и действует как посредник между моделью и представлением. Presenter явно не определен в предоставленном тексте, но обычно он координирует взаимодействие между моделью и представлением.

## Взаимодействие

- Класс AppData(модель) управляет данными и состоянием приложения. Он предоставляет методы для управления и извлечения данных, такие как очистка корзины, получение списка корзины, настройка каталога и многое другое.
Компоненты View ( Modal, Form, и т.д.) отображают данные модели на экране. Они также фиксируют взаимодействия и события пользователя, такие как изменения ввода и отправка форм.
- Presenter будет брать пользовательские взаимодействия, зафиксированные представлением, обрабатывать их по мере необходимости (возможно, используя методы, предоставляемые моделью), а затем обновлять представление, чтобы отразить любые изменения в данных или состоянии приложения.
- Класс EventEmitter может использоваться для облегчения связи между моделью, представлением и презентатором. Компоненты могут подписываться на события или прослушивать события и отвечать на них.
- Класс api взаимодействует с сервером, обрабатывая отправку и получение данных.
- Класс Component является базовым классом, от которого наследуются все остальные классы представлений. Он предоставляет общие методы для управления отображением и поведением элементов интерфейса.
- Класс Model является базовой моделью, что позволяет отличать его от простых объектов данных. Он предоставляет метод уведомления всех об изменении модели.
Таким образом, взаимодействие между компонентами в этом проекте представляет собой цикл потока данных от модели к представлению, взаимодействия пользователя с представлением к презентатору и обновлений от презентатора обратно к модели и представлению.

Таким образом, взаимодействие между компонентами в этом проекте представляет собой цикл потока данных от модели к представлению, взаимодействия пользователя с представлением к презентатору и обновлений от презентатора обратно к модели и представлению.

## Реализация процесса
Проект Web-larek основан на принципах объектно-ориентированного программирования (ООП) и архитектуры приложений. Он использует шаблон Model-View-Presenter (MVP), который включает в себя:

- model : обрабатывает данные, расчеты и бизнес-процессы.
- view : отображает пользовательский интерфейс и данные модели на экране.
- presenter : действует как посредник между моделью и представлением.

Типы данных и интерфейсы:
В проекте используется несколько типов данных и интерфейсов, в том числе: ICardProduct, IOrderForm, IContacts,IContactsForm, ICardItemIOrder

Класс AppData:
Класс AppData отвечает за данные всех функций, реализованных в проекте. Включает методы управления корзиной, каталогом, полями заказа и контактными полями

Базовый код:
Базовый код включает несколько классов: EventEmitter, api, Component, Model

Просмотреть компоненты:
Компоненты представления включают в себя несколько классов: Modal, Form, Success, Basket

Каждый из этих классов включает методы управления соответствующими компонентами.
